webpackJsonp([11],{xPOe:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("Xxa5"),r=a.n(o),l=a("mtWM"),s=a.n(l),i=a("NYxO"),d=a("2gGM"),n=a.n(d);function c(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function o(r,l){try{var s=e[r](l),i=s.value}catch(t){return void a(t)}if(!s.done)return Promise.resolve(i).then(function(t){o("next",t)},function(t){o("throw",t)});t(i)}("next")})}}var _={layout:"app",middleware:"auth",metaInfo:function(){return{title:"Projects"}},data:function(){return{projects:[],fileList:[],filesData:{model_id:"",model_name:"projects"},statuses:{in_progress:"success",done:"primary",on_hold:"danger"},current_project:{id:null,index:null},total_projects:0,per_page:0,table_loading:!0,add_project_dialog_show:!1,add_files_dialog_show:!1,edit_project_dialog_show:!1,form:new n.a({name:"",status:"in_progress",started_date:"",closed_date:""}),edit_form:new n.a({name:"",status:"in_progress",started_date:"",closed_date:""})}},mounted:function(){this.loadProjects(1)},computed:Object(i.mapGetters)({user:"auth/user"}),methods:{openFilesDialog:function(t){this.filesData.model_id=t,this.add_files_dialog_show=!0},filesUploaded:function(t){var e=this;this.add_files_dialog_show=!1,this.fileList=[],this.projects.forEach(function(a){a.id==e.filesData.model_id&&(a.files=t.data)})},loadProjects:function(t){var e=this;e.table_loading=!0,s.a.get("/api/v1/projects?page="+t).then(function(t){e.total_projects=parseInt(t.data.meta.total),e.per_page=parseInt(t.data.meta.per_page),e.projects=t.data.data,e.table_loading=!1}).catch(function(t){console.log(t)})},saveProject:function(){var t=c(r.a.mark(function t(){var e,a,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this,t.next=3,this.form.post("/api/v1/projects");case 3:a=t.sent,o=a.data,e.projects.unshift(o),e.total_projects++,e.form.name="",e.form.status="in_progress",e.add_project_dialog_show=!1;case 10:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),editProject:function(t){var e=this;e.projects.forEach(function(a){a.id==t&&(e.current_project.id=a.id,e.edit_form.name=a.name,e.edit_form.status=a.status,e.edit_form.started_date=a.started_date,e.edit_form.closed_date=a.closed_date,e.edit_project_dialog_show=!0)})},updateProject:function(){var t=c(r.a.mark(function t(){var e,a,o,l;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=(e=this).current_project.id,t.next=4,this.edit_form.patch("/api/v1/projects/"+a);case 4:o=t.sent,l=o.data,e.projects.forEach(function(t){t.id==a&&(t.name=l.name,t.status_formated=l.status_formated,t.status=l.status,t.started_date=l.started_date,t.closed_date=l.closed_date,e.edit_project_dialog_show=!1)});case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),deleteProject:function(t){var e=this,a=this;a.projects.forEach(function(o,r){o.id===t&&e.$confirm("This will permanently delete the record. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){e.edit_form.delete("/api/v1/projects/"+t).data;a.total_projects--,a.projects.splice(r,1)})})}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("Projects")]),t._v(" "),"admin"==t.user.role?a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(e){t.add_project_dialog_show=!0}}},[t._v("Add Project")]):t._e()],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.table_loading,expression:"table_loading"}],staticStyle:{width:"100%"},attrs:{data:t.projects,"default-sort":{prop:"created_at",order:"descending"}}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("ul",t._l(e.row.files,function(e,o){return a("li",{key:o},[a("a",{attrs:{href:e.full_url,target:"_blank"}},[t._v(t._s(e.file_name))]),t._v(" | "+t._s(e.created_at))])}))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"Name",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"billing_hours",label:"Billing Hours",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"work_hours",label:"Work Hours",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"status_formated",label:"Status",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t.statuses[e.row.status],"disable-transitions":""}},[t._v(t._s(e.row.status_formated))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"started_date",label:"Started At"}}),t._v(" "),a("el-table-column",{attrs:{prop:"closed_date",label:"Closed At"}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"Created At"}}),t._v(" "),"admin"==t.user.role?a("el-table-column",{attrs:{label:"Actions"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.editProject(e.row.id)}}},[t._v("Edit")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.deleteProject(e.row.id)}}},[t._v("Delete")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.openFilesDialog(e.row.id)}}},[a("i",{staticClass:"el-icon-upload"})])]}}])}):t._e()],1),t._v(" "),a("el-pagination",{staticStyle:{float:"right",padding:"12px"},attrs:{background:"",layout:"prev, pager, next",total:t.total_projects,"page-size":t.per_page},on:{"current-change":t.loadProjects}})],1),t._v(" "),a("el-dialog",{attrs:{title:"Add new project",visible:t.add_project_dialog_show,width:"30%"},on:{"update:visible":function(e){t.add_project_dialog_show=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"Project name"}},[a("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),t._v(" "),a("has-error",{attrs:{form:t.form,field:"name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Project status"}},[a("el-select",{attrs:{placeholder:"Select status"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[a("el-option",{attrs:{label:"In Progress",value:"in_progress"}}),t._v(" "),a("el-option",{attrs:{label:"Done",value:"done"}}),t._v(" "),a("el-option",{attrs:{label:"On hold",value:"on_hold"}}),t._v(" "),a("el-option",{attrs:{label:"Closed",value:"closed"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"Start Date"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"Select start date and time"},model:{value:t.form.started_date,callback:function(e){t.$set(t.form,"started_date",e)},expression:"form.started_date"}}),t._v(" "),a("has-error",{attrs:{form:t.form,field:"started_date"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Closed Date"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"Select closed date and time"},model:{value:t.form.closed_date,callback:function(e){t.$set(t.form,"closed_date",e)},expression:"form.closed_date"}}),t._v(" "),a("has-error",{attrs:{form:t.form,field:"closed_date"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.form.busy},on:{click:t.saveProject}},[t._v("Create")])],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"Edit project",visible:t.edit_project_dialog_show,width:"30%"},on:{"update:visible":function(e){t.edit_project_dialog_show=e}}},[a("el-form",{ref:"edit_form",attrs:{model:t.edit_form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"Project name"}},[a("el-input",{model:{value:t.edit_form.name,callback:function(e){t.$set(t.edit_form,"name",e)},expression:"edit_form.name"}}),t._v(" "),a("has-error",{attrs:{form:t.edit_form,field:"name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Project status"}},[a("el-select",{attrs:{placeholder:"Select status"},model:{value:t.edit_form.status,callback:function(e){t.$set(t.edit_form,"status",e)},expression:"edit_form.status"}},[a("el-option",{attrs:{label:"In Progress",value:"in_progress"}}),t._v(" "),a("el-option",{attrs:{label:"Done",value:"done"}}),t._v(" "),a("el-option",{attrs:{label:"On hold",value:"on_hold"}}),t._v(" "),a("el-option",{attrs:{label:"Closed",value:"closed"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"Start Date"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"Select start date and time"},model:{value:t.edit_form.started_date,callback:function(e){t.$set(t.edit_form,"started_date",e)},expression:"edit_form.started_date"}}),t._v(" "),a("has-error",{attrs:{form:t.edit_form,field:"started_date"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Closed Date"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"Select closed date and time"},model:{value:t.edit_form.closed_date,callback:function(e){t.$set(t.edit_form,"closed_date",e)},expression:"edit_form.closed_date"}}),t._v(" "),a("has-error",{attrs:{form:t.edit_form,field:"closed_date"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.edit_form.busy},on:{click:t.updateProject}},[t._v("Update")])],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"Upload Files",visible:t.add_files_dialog_show,width:"30%",center:""},on:{"update:visible":function(e){t.add_files_dialog_show=e}}},[a("el-upload",{attrs:{drag:"",action:"api/v1/files","file-list":t.fileList,"list-type":"text","auto-upload":!0,"on-success":t.filesUploaded,data:t.filesData,multiple:""}},[a("i",{staticClass:"el-icon-upload"}),t._v(" "),a("div",{staticClass:"el-upload__text"},[t._v("Drop file here or "),a("em",[t._v("click to upload")])])])],1)],1)},staticRenderFns:[]},f=a("VU/8")(_,u,!1,null,null,null);e.default=f.exports}});
//# sourceMappingURL=11.d891bc4d522fbcd431a1.js.map