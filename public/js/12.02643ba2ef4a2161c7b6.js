webpackJsonp([12],{iBoe:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Xxa5"),i=s.n(a),l=s("mtWM"),o=s.n(l),r=s("NYxO"),n=s("2gGM"),d=s.n(n);function u(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,s){return function a(i,l){try{var o=t[i](l),r=o.value}catch(e){return void s(e)}if(!o.done)return Promise.resolve(r).then(function(e){a("next",e)},function(e){a("throw",e)});e(r)}("next")})}}var _={layout:"app",middleware:"auth",metaInfo:function(){return{title:"Issues"}},data:function(){return{fileList:[],filesData:{model_id:"",model_name:"issues"},issues:[],projects:[],users:[],statuses:{in_progress:"success",done:"primary",on_hold:"danger"},current_issue:{id:null,index:null},total_issues:0,current_page:0,per_page:0,table_loading:!0,add_files_dialog_show:!1,add_issue_dialog_show:!1,edit_issue_dialog_show:!1,form:new d.a({project_id:"",assigned_by:"",assigned_to:"",issue_name:"",issue_status:"in_progress",issue_desc:""}),edit_form:new d.a({project_id:"",assigned_by:"",assigned_to:"",issue_name:"",issue_status:"in_progress",issue_desc:""}),filters:{user_id:!1,date:!1,project_id:"all"}}},mounted:function(){var e=this.$cookie.get("issues_filters");e&&(e=JSON.parse(e),this.filters.user_id=e.user_id,this.filters.date=e.date,this.filters.project_id=e.project_id),this.loadInitials(),this.loadIssues(1)},computed:Object(r.mapGetters)({user:"auth/user"}),methods:{openFilesDialog:function(e){this.filesData.model_id=e,this.add_files_dialog_show=!0},filesUploaded:function(e){var t=this;this.add_files_dialog_show=!1,this.fileList=[],this.issues.forEach(function(s){s.id==t.filesData.model_id&&(s.files=e.data)})},loadInitials:function(){var e=this,t=[{url:"/api/v1/projects?all",method:"get",data:"some-data"},{url:"/api/v1/users?all",method:"get",data:"some-other-data"}];o.a.all([o.a.request(t[0]).catch(function(){return!1}),o.a.request(t[1]).catch(function(){return!1})]).then(o.a.spread(function(t,s){!1!==t&&(e.projects=t.data.data),!1!==s&&(e.users=s.data.data)}))},loadIssues:function(e){var t=this;t.table_loading=!0,t.current_page=e,console.log(t.filters),this.$cookie.set("issues_filters",JSON.stringify(t.filters)),o.a.get("/api/v1/issues",{params:{page:e,filters:t.filters}}).then(function(e){t.total_issues=parseInt(e.data.meta.total),t.per_page=parseInt(e.data.meta.per_page),t.issues=e.data.data,t.table_loading=!1}).catch(function(e){console.log(e)})},saveIssue:function(){var e=u(i.a.mark(function e(){var t,s,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.next=3,this.form.post("/api/v1/issues");case 3:s=e.sent,a=s.data,t.issues.unshift(a),t.total_issues++,t.form.assigned_by="",t.form.assigned_to="",t.form.issue_desc="",t.form.issue_name="",t.form.issue_status="in_progress",t.add_issue_dialog_show=!1;case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),editIssue:function(e){var t=this;t.issues.forEach(function(s){s.id==e&&(t.current_issue.id=s.id,t.edit_form.project_id=s.project_id,t.edit_form.assigned_by=s.assigned_by_id,t.edit_form.assigned_by_id=s.assigned_by,t.edit_form.assigned_to=s.assigned_to_id,t.edit_form.assigned_to_id=s.assigned_to,t.edit_form.issue_desc=s.issue_desc,t.edit_form.issue_name=s.issue_name,t.edit_form.issue_status=s.issue_status,t.edit_issue_dialog_show=!0)})},updateIssue:function(){var e=u(i.a.mark(function e(){var t,s,a,l;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=(t=this).current_issue.id,e.next=4,this.edit_form.patch("/api/v1/issues/"+t.current_issue.id);case 4:a=e.sent,l=a.data,t.issues.forEach(function(e){e.id===s&&(e.status_formated=l.status_formated,e.project_id=l.project_id,e.project_name=l.project_name,e.assigned_by_id=l.assigned_by_id,e.assigned_by=l.assigned_by,e.assigned_to=l.assigned_to,e.assigned_to_id=l.assigned_to_id,e.issue_desc=l.issue_desc,e.issue_name=l.issue_name,e.issue_status=l.issue_status,e.issue_status_formated=l.issue_status_formated,t.edit_issue_dialog_show=!1)});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),deleteIssue:function(e){var t=this,s=this;s.issues.forEach(function(a,i){a.id===e&&t.$confirm("This will permanently delete the record. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){t.edit_form.delete("/api/v1/issues/"+e).data;s.total_issues--,s.issues.splice(i,1)})})}}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:4}},[s("div",{staticClass:"grid-content"},[s("span",[e._v("Issues")])])]),e._v(" "),s("el-col",{attrs:{span:16}},[s("div",{staticClass:"grid-content"},[s("div",{staticClass:"filters"},[s("el-form",{attrs:{inline:!0,"label-width":"120px"}},[s("el-form-item",{staticStyle:{margin:"0"},attrs:{label:"Filters : ",prop:"filters"}},[s("el-checkbox",{attrs:{label:"Assinged to me",name:"user_id"},on:{change:function(t){e.loadIssues(1)}},model:{value:e.filters.user_id,callback:function(t){e.$set(e.filters,"user_id",t)},expression:"filters.user_id"}}),e._v(" "),s("el-checkbox",{attrs:{label:"Today",name:"date"},on:{change:function(t){e.loadIssues(1)}},model:{value:e.filters.date,callback:function(t){e.$set(e.filters,"date",t)},expression:"filters.date"}})],1),e._v(" "),s("el-form-item",{staticStyle:{"margin-left":"18px"},attrs:{prop:"filters"}},[s("el-select",{attrs:{filterable:"",placeholder:"Select Project"},on:{change:function(t){e.loadIssues(1)}},model:{value:e.filters.project_id,callback:function(t){e.$set(e.filters,"project_id",t)},expression:"filters.project_id"}},[s("el-option",{attrs:{label:"All",value:"all"}}),e._v(" "),e._l(e.projects,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2)],1)],1)],1)])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"grid-content"},[s("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(t){e.add_issue_dialog_show=!0}}},[e._v("Add Issue")])],1)])],1)],1),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.table_loading,expression:"table_loading"}],staticStyle:{width:"100%"},attrs:{data:e.issues,"default-sort":{prop:"created_at",order:"descending"}}},[s("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v("Description: "+e._s(t.row.issue_desc))]),e._v(" "),s("p",[e._v("Assigned By: "+e._s(t.row.assigned_by))]),e._v(" "),s("ul",e._l(t.row.files,function(t,a){return s("li",{key:a},[s("a",{attrs:{href:t.full_url,target:"_blank"}},[e._v(e._s(t.file_name))]),e._v(" | "+e._s(t.created_at))])}))]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"id",label:"Issue ID",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"project_name",label:"Project Name",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"issue_name",label:"Issue Name",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"status_formated",label:"Status",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{type:e.statuses[t.row.issue_status],"disable-transitions":""}},[e._v(e._s(t.row.issue_status_formated))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"assigned_to",label:"Assigned To",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"created_at",label:"Created At",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"Actions"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{disabled:"admin"!=e.user.role&&t.row.assigned_by_id!=e.user.id&&t.row.assigned_to_id!=e.user.id,type:"text",size:"small"},on:{click:function(s){e.editIssue(t.row.id)}}},[e._v("Edit")]),e._v(" "),s("el-button",{attrs:{disabled:"admin"!=e.user.role&&t.row.assigned_by_id!=e.user.id&&t.row.assigned_to_id!=e.user.id,type:"text",size:"small"},on:{click:function(s){e.deleteIssue(t.row.id)}}},[e._v("Delete")]),e._v(" "),s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){e.openFilesDialog(t.row.id)}}},[s("i",{staticClass:"el-icon-upload"})])]}}])})],1),e._v(" "),s("el-pagination",{staticStyle:{float:"right",padding:"12px"},attrs:{background:"",layout:"prev, pager, next",total:e.total_issues,"page-size":e.per_page},on:{"current-change":e.loadIssues}})],1),e._v(" "),s("el-dialog",{attrs:{title:"Add new issue",visible:e.add_issue_dialog_show,width:"30%"},on:{"update:visible":function(t){e.add_issue_dialog_show=t}}},[s("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"Select Project"}},[s("el-select",{attrs:{placeholder:"Select project",filterable:""},model:{value:e.form.project_id,callback:function(t){e.$set(e.form,"project_id",t)},expression:"form.project_id"}},e._l(e.projects,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),s("has-error",{attrs:{form:e.form,field:"project_id"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Assinged by"}},[s("el-select",{attrs:{placeholder:"Select Assinged by",filterable:""},model:{value:e.form.assigned_by,callback:function(t){e.$set(e.form,"assigned_by",t)},expression:"form.assigned_by"}},e._l(e.users,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),s("has-error",{attrs:{form:e.form,field:"assigned_by"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Assinged to"}},[s("el-select",{attrs:{placeholder:"Select Assinged to",filterable:""},model:{value:e.form.assigned_to,callback:function(t){e.$set(e.form,"assigned_to",t)},expression:"form.assigned_to"}},e._l(e.users,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),s("has-error",{attrs:{form:e.form,field:"assigned_to"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Issue name"}},[s("el-input",{model:{value:e.form.issue_name,callback:function(t){e.$set(e.form,"issue_name",t)},expression:"form.issue_name"}}),e._v(" "),s("has-error",{attrs:{form:e.form,field:"issue_name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Issue Description"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form.issue_desc,callback:function(t){e.$set(e.form,"issue_desc",t)},expression:"form.issue_desc"}}),e._v(" "),s("has-error",{attrs:{form:e.form,field:"issue_desc"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Issue status"}},[s("el-select",{attrs:{placeholder:"Select status"},model:{value:e.form.issue_status,callback:function(t){e.$set(e.form,"issue_status",t)},expression:"form.issue_status"}},[s("el-option",{attrs:{label:"In Progress",value:"in_progress"}}),e._v(" "),s("el-option",{attrs:{label:"Done",value:"done"}}),e._v(" "),s("el-option",{attrs:{label:"Fixed",value:"fixed"}}),e._v(" "),s("el-option",{attrs:{label:"Resolved",value:"resolved"}}),e._v(" "),s("el-option",{attrs:{label:"On hold",value:"on_hold"}}),e._v(" "),s("el-option",{attrs:{label:"Closed",value:"closed"}})],1)],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",loading:e.form.busy},on:{click:e.saveIssue}},[e._v("Create")])],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"Edit issue",visible:e.edit_issue_dialog_show,width:"30%"},on:{"update:visible":function(t){e.edit_issue_dialog_show=t}}},[s("el-form",{ref:"edit_form",attrs:{model:e.edit_form,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"Select Project"}},[s("el-select",{attrs:{placeholder:"Select project",filterable:""},model:{value:e.edit_form.project_id,callback:function(t){e.$set(e.edit_form,"project_id",t)},expression:"edit_form.project_id"}},e._l(e.projects,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),s("has-error",{attrs:{form:e.edit_form,field:"project_id"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Assinged by"}},[s("el-select",{attrs:{placeholder:"Select Assinged by",filterable:""},model:{value:e.edit_form.assigned_by,callback:function(t){e.$set(e.edit_form,"assigned_by",t)},expression:"edit_form.assigned_by"}},e._l(e.users,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),s("has-error",{attrs:{form:e.edit_form,field:"assigned_by"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Assinged to"}},[s("el-select",{attrs:{placeholder:"Select Assinged to",filterable:""},model:{value:e.edit_form.assigned_to,callback:function(t){e.$set(e.edit_form,"assigned_to",t)},expression:"edit_form.assigned_to"}},[s("el-option",{attrs:{label:"All",value:"all"}}),e._v(" "),e._l(e.users,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2),e._v(" "),s("has-error",{attrs:{form:e.edit_form,field:"assigned_to"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Issue name"}},[s("el-input",{model:{value:e.edit_form.issue_name,callback:function(t){e.$set(e.edit_form,"issue_name",t)},expression:"edit_form.issue_name"}}),e._v(" "),s("has-error",{attrs:{form:e.edit_form,field:"issue_name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Issue Description"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.edit_form.issue_desc,callback:function(t){e.$set(e.edit_form,"issue_desc",t)},expression:"edit_form.issue_desc"}}),e._v(" "),s("has-error",{attrs:{form:e.edit_form,field:"issue_desc"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Issue status"}},[s("el-select",{attrs:{placeholder:"Select status"},model:{value:e.edit_form.issue_status,callback:function(t){e.$set(e.edit_form,"issue_status",t)},expression:"edit_form.issue_status"}},[s("el-option",{attrs:{label:"In Progress",value:"in_progress"}}),e._v(" "),s("el-option",{attrs:{label:"Done",value:"done"}}),e._v(" "),s("el-option",{attrs:{label:"On hold",value:"on_hold"}}),e._v(" "),s("el-option",{attrs:{label:"Closed",value:"closed"}})],1)],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",loading:e.edit_form.busy},on:{click:e.updateIssue}},[e._v("Update")])],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"Upload Files",visible:e.add_files_dialog_show,width:"30%",center:""},on:{"update:visible":function(t){e.add_files_dialog_show=t}}},[s("el-upload",{attrs:{drag:"",action:"api/v1/files","file-list":e.fileList,"list-type":"text","auto-upload":!0,"on-success":e.filesUploaded,data:e.filesData,multiple:""}},[s("i",{staticClass:"el-icon-upload"}),e._v(" "),s("div",{staticClass:"el-upload__text"},[e._v("Drop file here or "),s("em",[e._v("click to upload")])])])],1)],1)},staticRenderFns:[]},f=s("VU/8")(_,c,!1,null,null,null);t.default=f.exports}});
//# sourceMappingURL=12.02643ba2ef4a2161c7b6.js.map