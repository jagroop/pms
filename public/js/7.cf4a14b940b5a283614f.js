webpackJsonp([7],{Gwpo:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Xxa5"),l=r.n(a),o=r("mtWM"),s=r.n(o),n=r("NYxO"),i=r("2gGM"),u=r.n(i);function d(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function a(l,o){try{var s=t[l](o),n=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(n).then(function(e){a("next",e)},function(e){a("throw",e)});e(n)}("next")})}}var m={layout:"app",middleware:"auth",metaInfo:function(){return{title:"Users"}},data:function(){return{users:[],statuses:{in_progress:"success",done:"primary",on_hold:"danger"},current_user:{id:null,index:null},total_users:0,per_page:0,table_loading:!0,add_user_dialog_show:!1,edit_user_dialog_show:!1,form:new u.a({role:"developer",name:"",email:""}),edit_form:new u.a({role:"developer",name:"",email:""})}},mounted:function(){this.loadUsers(1)},computed:Object(n.mapGetters)({user:"auth/user"}),methods:{loadUsers:function(e){var t=this;t.table_loading=!0,s.a.get("/api/v1/users?page="+e).then(function(e){t.total_users=parseInt(e.data.meta.total),t.per_page=parseInt(e.data.meta.per_page),t.users=e.data.data,t.table_loading=!1}).catch(function(e){console.log(e)})},saveUser:function(){var e=d(l.a.mark(function e(){var t,r,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.next=3,this.form.post("/api/v1/users");case 3:r=e.sent,a=r.data,t.users.unshift(a),t.total_users++,t.form.name="",t.form.email="",t.form.role="developer",t.add_user_dialog_show=!1;case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),editUser:function(e){var t=this;t.users.forEach(function(r){r.id==e&&(t.current_user.id=r.id,t.edit_form.name=r.name,t.edit_form.role=r.role,t.edit_form.email=r.email,t.edit_user_dialog_show=!0)})},updateUser:function(){var e=d(l.a.mark(function e(){var t,r,a,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(t=this).current_user.id,e.next=4,this.edit_form.patch("/api/v1/users/"+r);case 4:a=e.sent,o=a.data,t.users.forEach(function(e){e.id==r&&(e.name=o.name,e.email=o.email,e.role_formated=o.role_formated,e.role=o.role,t.edit_user_dialog_show=!1)});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),deleteUser:function(e){var t=this,r=this;r.users.forEach(function(a,l){a.id===e&&t.$confirm("This will permanently delete the record. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){t.edit_form.delete("/api/v1/users/"+e).data;r.total_users--,r.users.splice(l,1)})})}}},c={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("Users")]),e._v(" "),"admin"==e.user.role?r("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(t){e.add_user_dialog_show=!0}}},[e._v("Add User")]):e._e()],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.table_loading,expression:"table_loading"}],staticStyle:{width:"100%"},attrs:{data:e.users,"default-sort":{prop:"created_at",order:"descending"}}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",[e._v("Tasks")]),e._v(" "),r("ul",e._l(t.row.tasks,function(t,a){return r("li",[r("strong",[e._v(e._s(t.status))]),e._v(" : "+e._s(t.count))])})),e._v(" "),r("p",[e._v("Issues")]),e._v(" "),r("ul",e._l(t.row.issues,function(t,a){return r("li",[r("strong",[e._v(e._s(t.status))]),e._v(" : "+e._s(t.count))])}))]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"name",label:"Name",sortable:""}}),e._v(" "),r("el-table-column",{attrs:{prop:"email",label:"Email",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("a",{attrs:{href:"mailto:"+t.row.email}},[e._v(e._s(t.row.email))])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"role_formated",label:"Role",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{"disable-transitions":""}},[e._v(e._s(t.row.role_formated))])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"created_at",label:"Created At",sortable:""}}),e._v(" "),r("el-table-column",{attrs:{prop:"total_tasks",label:"Today tasks",sortable:""}}),e._v(" "),r("el-table-column",{attrs:{prop:"total_issues",label:"Today issues",sortable:""}}),e._v(" "),"admin"==e.user.role?r("el-table-column",{attrs:{label:"Actions"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.editUser(t.row.id)}}},[e._v("Edit")]),e._v(" "),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.deleteUser(t.row.id)}}},[e._v("Delete")])]}}])}):e._e()],1),e._v(" "),r("el-pagination",{staticStyle:{float:"right",padding:"12px"},attrs:{background:"",layout:"prev, pager, next",total:e.total_users,"page-size":e.per_page},on:{"current-change":e.loadUsers}})],1),e._v(" "),r("el-dialog",{attrs:{title:"Add new user",visible:e.add_user_dialog_show,width:"30%"},on:{"update:visible":function(t){e.add_user_dialog_show=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"User role"}},[r("el-select",{attrs:{placeholder:"Select role"},model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}},[r("el-option",{attrs:{label:"Developer",value:"developer"}}),e._v(" "),r("el-option",{attrs:{label:"Admin",value:"admin"}}),e._v(" "),r("el-option",{attrs:{label:"Maintainer",value:"maintainer"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"Name"}},[r("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),e._v(" "),r("has-error",{attrs:{form:e.form,field:"name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Email"}},[r("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}}),e._v(" "),r("has-error",{attrs:{form:e.form,field:"email"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",loading:e.form.busy},on:{click:e.saveUser}},[e._v("Create")])],1)],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"Edit user",visible:e.edit_user_dialog_show,width:"30%"},on:{"update:visible":function(t){e.edit_user_dialog_show=t}}},[r("el-form",{ref:"edit_form",attrs:{model:e.edit_form,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"User role"}},[r("el-select",{attrs:{placeholder:"Select role"},model:{value:e.edit_form.role,callback:function(t){e.$set(e.edit_form,"role",t)},expression:"edit_form.role"}},[r("el-option",{attrs:{label:"Developer",value:"developer"}}),e._v(" "),r("el-option",{attrs:{label:"Admin",value:"admin"}}),e._v(" "),r("el-option",{attrs:{label:"Maintainer",value:"maintainer"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"Name"}},[r("el-input",{model:{value:e.edit_form.name,callback:function(t){e.$set(e.edit_form,"name",t)},expression:"edit_form.name"}}),e._v(" "),r("has-error",{attrs:{form:e.edit_form,field:"name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Email"}},[r("el-input",{model:{value:e.edit_form.email,callback:function(t){e.$set(e.edit_form,"email",t)},expression:"edit_form.email"}}),e._v(" "),r("has-error",{attrs:{form:e.edit_form,field:"email"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",loading:e.edit_form.busy},on:{click:e.updateUser}},[e._v("Update")])],1)],1)],1)],1)},staticRenderFns:[]},_=r("VU/8")(m,c,!1,null,null,null);t.default=_.exports}});
//# sourceMappingURL=7.cf4a14b940b5a283614f.js.map