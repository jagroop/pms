webpackJsonp([8],{"ux+C":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Xxa5"),r=s.n(a),o=s("mtWM"),l=s.n(o),i=s("NYxO"),n=s("2gGM"),d=s.n(n);function _(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,s){return function a(r,o){try{var l=t[r](o),i=l.value}catch(e){return void s(e)}if(!l.done)return Promise.resolve(i).then(function(e){a("next",e)},function(e){a("throw",e)});e(i)}("next")})}}var c={layout:"app",middleware:"auth",metaInfo:function(){return{title:"Tasks"}},data:function(){return{fileList:[],filesData:{model_id:"",model_name:"tasks"},tasks:[],projects:[],users:[],statuses:{in_progress:"primary",done:"success",on_hold:"danger",closed:"danger",deployed:"warning",feedback:"info",bug:"danger"},current_task:{id:null,index:null},total_tasks:0,current_page:0,per_page:0,table_loading:!0,add_task_dialog_show:!1,add_files_dialog_show:!1,edit_task_dialog_show:!1,form:new d.a({project_id:"",assigned_by:"",assigned_to:"",task_name:"",completion_precentage:0,task_status:"in_progress",task_desc:"",billing_hours:0,work_hours:0}),edit_form:new d.a({project_id:"",assigned_by:"",assigned_to:"",task_name:"",completion_precentage:0,task_status:"in_progress",task_desc:"",work_hours:"",disable_work_hours:!1,disable_check:!1,billing_hours:""}),filters:{user_id:!1,date:!1,project_id:"all"}}},mounted:function(){var e=this.$cookie.get("filters");e&&(e=JSON.parse(e),this.filters.user_id=e.user_id,this.filters.date=e.date,this.filters.project_id=e.project_id),this.loadInitials(),this.loadTasks(1)},computed:Object(i.mapGetters)({user:"auth/user"}),methods:{openFilesDialog:function(e){this.filesData.model_id=e,this.add_files_dialog_show=!0},filesUploaded:function(e){var t=this;this.add_files_dialog_show=!1,this.fileList=[],this.tasks.forEach(function(s){s.id==t.filesData.model_id&&(s.files=e.data)})},loadInitials:function(){var e=this,t=[{url:"/api/v1/projects?all",method:"get",data:"some-data"},{url:"/api/v1/users?all",method:"get",data:"some-other-data"}];l.a.all([l.a.request(t[0]).catch(function(){return!1}),l.a.request(t[1]).catch(function(){return!1})]).then(l.a.spread(function(t,s){!1!==t&&(e.projects=t.data.data),!1!==s&&(e.users=s.data.data)}))},loadTasks:function(e){var t=this;t.table_loading=!0,t.current_page=e,this.$cookie.set("filters",JSON.stringify(t.filters)),l.a.get("/api/v1/tasks",{params:{page:e,filters:t.filters}}).then(function(e){t.total_tasks=parseInt(e.data.meta.total),t.per_page=parseInt(e.data.meta.per_page),t.tasks=e.data.data,t.table_loading=!1}).catch(function(e){console.log(e)})},saveTask:function(){var e=_(r.a.mark(function e(){var t,s,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.next=3,this.form.post("/api/v1/tasks");case 3:s=e.sent,a=s.data,t.tasks.unshift(a),t.total_tasks++,t.form.assigned_by="",t.form.assigned_to="",t.form.task_desc="",t.form.billing_hours="",t.form.work_hours="",t.form.task_name="",t.form.completion_precentage=0,t.form.task_status="in_progress",t.add_task_dialog_show=!1;case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),editTask:function(e){var t=this;t.tasks.forEach(function(s){s.id==e&&(t.current_task.id=s.id,t.edit_form.project_id=s.project_id,t.edit_form.assigned_by=s.assigned_by_id,t.edit_form.assigned_by_id=s.assigned_by,t.edit_form.assigned_to=s.assigned_to_id,t.edit_form.assigned_to_id=s.assigned_to,t.edit_form.task_desc=s.task_desc,t.edit_form.billing_hours=s.billing_hours,t.edit_form.work_hours=s.work_hours,t.edit_form.task_name=s.task_name,t.edit_form.completion_precentage=s.completion_precentage,t.edit_form.task_status=s.task_status,t.edit_form.disable_work_hours=s.disable_work_hours,t.edit_form.disable_check=s.disable_check,t.edit_task_dialog_show=!0)})},updateTask:function(){var e=_(r.a.mark(function e(){var t,s,a,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=(t=this).current_task.id,e.next=4,this.edit_form.patch("/api/v1/tasks/"+t.current_task.id);case 4:a=e.sent,o=a.data,t.tasks.forEach(function(e){e.id===s&&(e.status_formated=o.status_formated,e.project_id=o.project_id,e.project_name=o.project_name,e.assigned_by_id=o.assigned_by_id,e.assigned_by=o.assigned_by,e.assigned_to=o.assigned_to,e.assigned_to_id=o.assigned_to_id,e.task_desc=o.task_desc,e.task_name=o.task_name,e.activity=o.activity,e.completion_precentage=o.completion_precentage,e.billing_hours=o.billing_hours,e.work_hours=o.work_hours,e.disable_work_hours=o.disable_work_hours,e.disable_check=o.disable_check,e.percentage_status=o.percentage_status,e.task_status=o.task_status,e.task_status_formated=o.task_status_formated,t.edit_task_dialog_show=!1)});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),deleteTask:function(e){var t=this,s=this;s.tasks.forEach(function(a,r){a.id===e&&t.$confirm("This will permanently delete the record. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){t.edit_form.delete("/api/v1/tasks/"+e).data;s.total_tasks--,s.tasks.splice(r,1)})})}}},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:4}},[s("div",{staticClass:"grid-content"},[s("span",[e._v("Tasks")])])]),e._v(" "),s("el-col",{attrs:{span:16}},[s("div",{staticClass:"grid-content"},[s("div",{staticClass:"filters"},[s("el-form",{attrs:{inline:!0,"label-width":"120px"}},[s("el-form-item",{staticStyle:{margin:"0"},attrs:{label:"Filters : ",prop:"filters"}},[s("el-checkbox",{attrs:{label:"Assinged to me",name:"user_id"},on:{change:function(t){e.loadTasks(1)}},model:{value:e.filters.user_id,callback:function(t){e.$set(e.filters,"user_id",t)},expression:"filters.user_id"}}),e._v(" "),s("el-checkbox",{attrs:{label:"Today",name:"date"},on:{change:function(t){e.loadTasks(1)}},model:{value:e.filters.date,callback:function(t){e.$set(e.filters,"date",t)},expression:"filters.date"}})],1),e._v(" "),s("el-form-item",{staticStyle:{"margin-left":"18px"},attrs:{prop:"filters"}},[s("el-select",{attrs:{filterable:"",placeholder:"Select Project"},on:{change:function(t){e.loadTasks(1)}},model:{value:e.filters.project_id,callback:function(t){e.$set(e.filters,"project_id",t)},expression:"filters.project_id"}},[s("el-option",{attrs:{label:"All",value:"all"}}),e._v(" "),e._l(e.projects,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2)],1)],1)],1)])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"grid-content"},[s("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(t){e.add_task_dialog_show=!0}}},[e._v("Add Task")])],1)])],1)],1),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.table_loading,expression:"table_loading"}],staticStyle:{width:"100%"},attrs:{data:e.tasks,"default-sort":{prop:"created_at",order:"descending"}}},[s("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[s("strong",[e._v("Description:")]),e._v(" "+e._s(t.row.task_desc))]),e._v(" "),s("p",[s("strong",[e._v("Assigned By:")]),e._v(" "+e._s(t.row.assigned_by))]),e._v(" "),s("p",[s("strong",[e._v("Billing Hours:")]),e._v(" "+e._s(t.row.billing_hours))]),e._v(" "),s("p",[s("strong",[e._v("Work Hours:")]),e._v(" "+e._s(t.row.work_hours))]),e._v(" "),s("p",[s("strong",[e._v("Activity Logs:")])]),e._v(" "),s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},e._l(t.row.activity,function(t,a){return s("el-breadcrumb-item",{key:a,attrs:{title:t.created_at+" | "+t.created_at_human}},[e._v(e._s(t.label))])})),e._v(" "),s("br"),e._v(" "),s("p",[s("strong",[e._v("Attachments:")])]),e._v(" "),s("ul",e._l(t.row.files,function(t,a){return s("li",{key:a},[s("a",{attrs:{href:t.full_url,target:"_blank"}},[e._v(e._s(t.file_name))]),e._v(" | "+e._s(t.created_at))])}))]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"id",label:"Task ID",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"project_name",label:"Project Name",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"task_name",label:"Task Name",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"status_formated",label:"Status",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{type:e.statuses[t.row.task_status],"disable-transitions":""}},[e._v(e._s(t.row.task_status_formated))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"completion_precentage",label:"Progress",sortable:""},scopedSlots:e._u([{key:"default",fn:function(e){return[s("el-progress",{staticStyle:{width:"55%"},attrs:{"text-inside":!0,"stroke-width":14,status:e.row.percentage_status,percentage:e.row.completion_precentage}})]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"assigned_to",label:"Assigned To",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"created_at",label:"Created At",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"Actions"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{disabled:"admin"!=e.user.role&&t.row.assigned_by_id!=e.user.id&&t.row.assigned_to_id!=e.user.id,type:"text",size:"small"},on:{click:function(s){e.editTask(t.row.id)}}},[e._v("Edit")]),e._v(" "),s("el-button",{attrs:{disabled:"admin"!=e.user.role&&t.row.assigned_by_id!=e.user.id&&t.row.assigned_to_id!=e.user.id,type:"text",size:"small"},on:{click:function(s){e.deleteTask(t.row.id)}}},[e._v("Delete")]),e._v(" "),s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){e.openFilesDialog(t.row.id)}}},[s("i",{staticClass:"el-icon-upload"})])]}}])})],1),e._v(" "),s("el-pagination",{staticStyle:{float:"right",padding:"12px"},attrs:{background:"",layout:"prev, pager, next",total:e.total_tasks,"page-size":e.per_page},on:{"current-change":e.loadTasks}})],1),e._v(" "),s("el-dialog",{attrs:{title:"Add new task",visible:e.add_task_dialog_show,width:"30%"},on:{"update:visible":function(t){e.add_task_dialog_show=t}}},[s("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"Select Project"}},[s("el-select",{attrs:{placeholder:"Select project",filterable:""},model:{value:e.form.project_id,callback:function(t){e.$set(e.form,"project_id",t)},expression:"form.project_id"}},e._l(e.projects,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),s("has-error",{attrs:{form:e.form,field:"project_id"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Assinged by"}},[s("el-select",{attrs:{placeholder:"Select Assinged by",filterable:""},model:{value:e.form.assigned_by,callback:function(t){e.$set(e.form,"assigned_by",t)},expression:"form.assigned_by"}},e._l(e.users,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),s("has-error",{attrs:{form:e.form,field:"assigned_by"}})],1),e._v(" "),"admin"==e.user.role?s("el-form-item",{attrs:{label:"Assinged to"}},[s("el-select",{attrs:{placeholder:"Select Assinged to",filterable:""},model:{value:e.form.assigned_to,callback:function(t){e.$set(e.form,"assigned_to",t)},expression:"form.assigned_to"}},e._l(e.users,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),s("has-error",{attrs:{form:e.form,field:"assigned_to"}})],1):e._e(),e._v(" "),s("el-form-item",{attrs:{label:"Task name"}},[s("el-input",{model:{value:e.form.task_name,callback:function(t){e.$set(e.form,"task_name",t)},expression:"form.task_name"}}),e._v(" "),s("has-error",{attrs:{form:e.form,field:"task_name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Task Description"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form.task_desc,callback:function(t){e.$set(e.form,"task_desc",t)},expression:"form.task_desc"}}),e._v(" "),s("has-error",{attrs:{form:e.form,field:"task_desc"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Billing Hours"}},[s("el-input",{model:{value:e.form.billing_hours,callback:function(t){e.$set(e.form,"billing_hours",t)},expression:"form.billing_hours"}}),e._v(" "),s("has-error",{attrs:{form:e.form,field:"billing_hours"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Work Hours"}},[s("el-input",{model:{value:e.form.work_hours,callback:function(t){e.$set(e.form,"work_hours",t)},expression:"form.work_hours"}}),e._v(" "),s("has-error",{attrs:{form:e.form,field:"work_hours"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Task status"}},[s("el-select",{attrs:{placeholder:"Select status"},model:{value:e.form.task_status,callback:function(t){e.$set(e.form,"task_status",t)},expression:"form.task_status"}},[s("el-option",{attrs:{label:"In Progress",value:"in_progress"}}),e._v(" "),s("el-option",{attrs:{label:"Done",value:"done"}}),e._v(" "),s("el-option",{attrs:{label:"On hold",value:"on_hold"}}),e._v(" "),s("el-option",{attrs:{label:"Closed",value:"closed"}}),e._v(" "),s("el-option",{attrs:{label:"Deployed",value:"deployed"}}),e._v(" "),s("el-option",{attrs:{label:"Feedback",value:"feedback"}}),e._v(" "),s("el-option",{attrs:{label:"Bug",value:"bug"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"Progress"}},[s("el-slider",{attrs:{step:10,"show-stops":""},model:{value:e.form.completion_precentage,callback:function(t){e.$set(e.form,"completion_precentage",t)},expression:"form.completion_precentage"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",loading:e.form.busy},on:{click:e.saveTask}},[e._v("Create")])],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"Edit task",visible:e.edit_task_dialog_show,width:"30%"},on:{"update:visible":function(t){e.edit_task_dialog_show=t}}},[s("el-form",{ref:"edit_form",attrs:{model:e.edit_form,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"Select Project"}},[s("el-select",{attrs:{placeholder:"Select project",filterable:""},model:{value:e.edit_form.project_id,callback:function(t){e.$set(e.edit_form,"project_id",t)},expression:"edit_form.project_id"}},e._l(e.projects,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),s("has-error",{attrs:{form:e.edit_form,field:"project_id"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Assinged by"}},[s("el-select",{attrs:{placeholder:"Select Assinged by",filterable:""},model:{value:e.edit_form.assigned_by,callback:function(t){e.$set(e.edit_form,"assigned_by",t)},expression:"edit_form.assigned_by"}},e._l(e.users,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),s("has-error",{attrs:{form:e.edit_form,field:"assigned_by"}})],1),e._v(" "),"admin"==e.user.role?s("el-form-item",{attrs:{label:"Assinged to"}},[s("el-select",{attrs:{placeholder:"Select Assinged to",filterable:""},model:{value:e.edit_form.assigned_to,callback:function(t){e.$set(e.edit_form,"assigned_to",t)},expression:"edit_form.assigned_to"}},e._l(e.users,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),s("has-error",{attrs:{form:e.edit_form,field:"assigned_to"}})],1):e._e(),e._v(" "),s("el-form-item",{attrs:{label:"Task name"}},[s("el-input",{model:{value:e.edit_form.task_name,callback:function(t){e.$set(e.edit_form,"task_name",t)},expression:"edit_form.task_name"}}),e._v(" "),s("has-error",{attrs:{form:e.edit_form,field:"task_name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Task Description"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.edit_form.task_desc,callback:function(t){e.$set(e.edit_form,"task_desc",t)},expression:"edit_form.task_desc"}}),e._v(" "),s("has-error",{attrs:{form:e.edit_form,field:"task_desc"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Billing Hours"}},[s("el-input",{model:{value:e.edit_form.billing_hours,callback:function(t){e.$set(e.edit_form,"billing_hours",t)},expression:"edit_form.billing_hours"}}),e._v(" "),s("has-error",{attrs:{form:e.edit_form,field:"billing_hours"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Work Hours"}},[s("el-input",{attrs:{disabled:e.edit_form.disable_work_hours||e.edit_form.disable_check},model:{value:e.edit_form.work_hours,callback:function(t){e.$set(e.edit_form,"work_hours",t)},expression:"edit_form.work_hours"}}),e._v(" "),s("has-error",{attrs:{form:e.edit_form,field:"work_hours"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Task status"}},[s("el-select",{attrs:{placeholder:"Select status"},model:{value:e.edit_form.task_status,callback:function(t){e.$set(e.edit_form,"task_status",t)},expression:"edit_form.task_status"}},[s("el-option",{attrs:{label:"In Progress",value:"in_progress"}}),e._v(" "),s("el-option",{attrs:{label:"Done",value:"done"}}),e._v(" "),s("el-option",{attrs:{label:"On hold",value:"on_hold"}}),e._v(" "),s("el-option",{attrs:{label:"Closed",value:"closed"}}),e._v(" "),s("el-option",{attrs:{label:"Deployed",value:"deployed"}}),e._v(" "),s("el-option",{attrs:{label:"Feedback",value:"feedback"}}),e._v(" "),s("el-option",{attrs:{label:"Bug",value:"bug"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"Progress"}},[s("el-slider",{attrs:{step:10,"show-stops":""},model:{value:e.edit_form.completion_precentage,callback:function(t){e.$set(e.edit_form,"completion_precentage",t)},expression:"edit_form.completion_precentage"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",loading:e.edit_form.busy},on:{click:e.updateTask}},[e._v("Update")])],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"Upload Files",visible:e.add_files_dialog_show,width:"30%",center:""},on:{"update:visible":function(t){e.add_files_dialog_show=t}}},[s("el-upload",{attrs:{drag:"",action:"api/v1/files","file-list":e.fileList,"list-type":"text","auto-upload":!0,"on-success":e.filesUploaded,data:e.filesData,multiple:""}},[s("i",{staticClass:"el-icon-upload"}),e._v(" "),s("div",{staticClass:"el-upload__text"},[e._v("Drop file here or "),s("em",[e._v("click to upload")])])])],1)],1)},staticRenderFns:[]},f=s("VU/8")(c,u,!1,null,null,null);t.default=f.exports}});
//# sourceMappingURL=8.3d03de8435a96556b90d.js.map